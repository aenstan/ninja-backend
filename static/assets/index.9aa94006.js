var e=Object.defineProperty,o=Object.defineProperties,t=Object.getOwnPropertyDescriptors,a=Object.getOwnPropertySymbols,s=Object.prototype.hasOwnProperty,c=Object.prototype.propertyIsEnumerable,r=(o,t,a)=>t in o?e(o,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):o[t]=a,n=(e,o)=>{for(var t in o||(o={}))s.call(o,t)&&r(e,t,o[t]);if(a)for(var t of a(o))c.call(o,t)&&r(e,t,o[t]);return e},l=(e,a)=>o(e,t(a));import{p as i,a as d,o as u,c as p,r as m,b as k,w as g,F as f,k as v,d as y,e as h,t as b,f as w,g as C,u as j,h as _,_ as I,i as x,j as O,l as S,m as V,n as L,q as T,s as z}from"./vendor.c1de5344.js";i("data-v-4b23e37a"),d();const P={},Q={class:"NinjaLogo",src:"/assets/logo.03d6d6da.png",alt:"logo"};P.render=function(e,o){return u(),p("img",Q)};const A={components:{Logo:P}},N=g();i("data-v-1f23ce5f");const R={class:"header"},q={class:"header-wrapper"},U={class:"flex items-center"},E=k("p",{class:"pl-3 select-none"},"Ninja",-1);d();const K=N(((e,o,t,a,s,c)=>{const r=m("Logo");return u(),p("div",R,[k("div",q,[k("div",U,[k(r,{class:"h-10 w-10"}),E])])])}));A.render=K,A.__scopeId="data-v-1f23ce5f";const D={class:"main"},F={expose:[],setup:e=>(e,o)=>{const t=m("router-view");return u(),p(f,null,[k(A),k("div",D,[k(t)])],64)}};const B=v.create({prefixUrl:"/api",retry:{limit:1}});const G={setup(){const e=j();_();let o=y({nickName:void 0,timestamp:void 0,pushToken:""});const t=async()=>{try{const e=localStorage.getItem("eid");if(!e)return void a();const t=await function(e){const o=new URLSearchParams;return o.set("eid",e),B.get("userinfo",{searchParams:o}).json()}(e);if(!t)return I.error("获取用户信息失败，请重重新登录"),void a();o.nickName=t.data.nickName,o.timestamp=new Date(t.data.timestamp).toLocaleString(),o.pushToken=t.data.push_token}catch(e){console.error(e)}};h(t);const a=()=>{localStorage.removeItem("eid"),e.push("/login")};return l(n({},b(o)),{getInfo:t,logout:a,delAccount:async()=>{try{const e=localStorage.getItem("eid"),o=await function(e){return B.post("delaccount",{json:e}).json()}({eid:e});200!==o.code?I.error(o.message):(I.success(o.message),setTimeout((()=>{a()}),1e3))}catch(e){console.error(e)}},uploadpushToken:async()=>{try{const t=localStorage.getItem("eid"),a=await(e={eid:t,push_token:o.pushToken},B.post("uploadpushtoken",{json:e}).json());200!==a.code?I.error(a.message):I.success(a.message)}catch(t){console.error(t)}var e}})}},H={class:"content"},J={class:"card"},M=k("div",{class:"card-header"},[k("p",{class:"card-title"},"个人中心")],-1),W={class:"card-body"},X={class:"card-footer"},Y=x("退出登录"),Z=x("删除账号"),$={class:"card"},ee=k("div",{class:"card-header"},[k("p",{class:"card-title"},"消息推送"),k("span",{class:"card-subtitle"}," 请在下方输入您的 push plus token 测试后保存。 ")],-1),oe={class:"card-body"},te={class:"card-footer"},ae=x("保存");G.render=function(e,o,t,a,s,c){const r=m("el-button"),n=m("el-input");return u(),p("div",H,[k("div",J,[M,k("div",W,[k("p",null,"昵称："+w(e.nickName),1),k("p",null,"更新时间："+w(e.timestamp),1)]),k("div",X,[k(r,{size:"small",auto:"",onClick:a.logout},{default:C((()=>[Y])),_:1},8,["onClick"]),k(r,{type:"danger",size:"small",auto:"",onClick:a.delAccount},{default:C((()=>[Z])),_:1},8,["onClick"])])]),k("div",$,[ee,k("div",oe,[k(n,{modelValue:e.pushToken,"onUpdate:modelValue":o[1]||(o[1]=o=>e.pushToken=o),placeholder:"token",size:"small",clearable:"",class:"my-4 w-full"},null,8,["modelValue"])]),k("div",te,[k(r,{type:"success",size:"small",auto:"",onClick:a.uploadpushToken},{default:C((()=>[ae])),_:1},8,["onClick"])])])])};const se={setup(){const e=j();_();let o=y({marginCount:0,allowAdd:!0,cookie:"",QRCode:void 0,qrCodeVisibility:!1,token:void 0,okl_token:void 0,cookies:void 0,timer:void 0});const t=async()=>{try{const e=(await B.get("info").json()).data;o.marginCount=e.marginCount,o.allowAdd=e.allowAdd}catch(e){console.error(e)}},a=async()=>{try{const t=await function(e){return B.post("check",{json:e}).json()}({token:o.token,okl_token:o.okl_token,cookies:o.cookies});switch(null==t?void 0:t.data.errcode){case 0:localStorage.setItem("eid",t.data.eid),I.success(t.message),clearInterval(o.timer),e.push("/");break;case 176:break;default:I.error(t.message),clearInterval(o.timer)}}catch(t){clearInterval(o.timer)}};return h(t),l(n({},b(o)),{getInfo:t,getQrcode:async()=>{try{const e=await B.get("qrcode").json();o.token=e.data.token,o.okl_token=e.data.okl_token,o.cookies=e.data.cookies,o.QRCode=e.data.QRCode,o.QRCode&&(o.qrCodeVisibility=!0,clearInterval(o.timer),o.timer=setInterval(a,3e3))}catch(e){console.error(e),I.error("生成二维码失败！请重试或放弃")}},ckeckLogin:a,CKLogin:async()=>{try{const e=o.cookie.match(/pt_key=(.*?);/)&&o.cookie.match(/pt_key=(.*?);/)[1],t=o.cookie.match(/pt_pin=(.*?);/)&&o.cookie.match(/pt_pin=(.*?);/)[1];if(e&&t){const o=await function(e){return B.post("cklogin",{json:e}).json()}({pt_key:e,pt_pin:t});200===o.code&&o.data.eid?(localStorage.setItem("eid",o.data.eid),I.success(o.message)):I.error(o.message||"cookie 解析失败，请检查后重试！")}else I.error("cookie 解析失败，请检查后重试！")}catch(e){console.error(e)}}})}},ce={class:"content"},re={class:"card"},ne={class:"card-header"},le={class:"flex items-center justify-between"},ie=k("p",{class:"card-title"},"扫码登录",-1),de={class:"ml-2 px-2 py-1 bg-gray-200 rounded-full font-normal text-xs"},ue=k("span",{class:"card-subtitle"}," 请使用京东 App 扫码登录（手机截图扫码）。升级提示不用管。 ",-1),pe={class:"card-body text-center"},me=x("生成二维码"),ke=k("div",{class:"card-footer"},null,-1),ge={class:"card hidden"},fe={class:"card-header"},ve={class:"flex items-center justify-between"},ye=k("p",{class:"card-title"},"CK 登录",-1),he={class:"ml-2 px-2 py-1 bg-gray-200 rounded-full font-normal text-xs"},be=k("span",{class:"card-subtitle"}," 请在下方输入您的 cookie 登录。 ",-1),we={class:"card-body text-center"},Ce=x("登录"),je=k("div",{class:"card-footet"},null,-1);se.render=function(e,o,t,a,s,c){const r=m("el-button"),n=m("el-input");return u(),p("div",ce,[k("div",re,[k("div",ne,[k("div",le,[ie,k("span",de,"余量："+w(e.marginCount),1)]),ue]),k("div",pe,[e.qrCodeVisibility?(u(),p("img",{key:0,src:e.QRCode,width:256,class:"m-auto"},null,8,["src"])):O("",!0),k(r,{type:"primary",size:"small",round:"",onClick:a.getQrcode},{default:C((()=>[me])),_:1},8,["onClick"])]),ke]),k("div",ge,[k("div",fe,[k("div",ve,[ye,k("span",he,"余量："+w(e.marginCount),1)]),be]),k("div",we,[k(n,{modelValue:e.cookie,"onUpdate:modelValue":o[1]||(o[1]=o=>e.cookie=o),size:"small",clearable:"",class:"my-4 w-full"},null,8,["modelValue"]),k(r,{type:"primary",size:"small",round:"",onClick:a.CKLogin},{default:C((()=>[Ce])),_:1},8,["onClick"])]),je])])};const _e=[{path:"/",component:G},{path:"/login",component:se}],Ie=S({history:V(),routes:_e}),xe=[T,z,I],Oe=[I],Se=L(F);xe.forEach((e=>{Se.component(e.name,e)})),Oe.forEach((e=>{Se.use(e)})),Se.use(Ie),Se.mount("#app");
